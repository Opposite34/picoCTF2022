### Current progress: Done

A `vuln` executable and `vuln.c` was given.

We checked via `file` and `checksec` command which shows that `vuln` is a:
- amd64 little endian
- unstripped ELF binary
- NX is enabled

64 bit binary is a bit tricky to overflow, as sometimes you need to realign the stack by 
16 bytes when `MOVDQA` is used alongside `XMM` register (see [this blog post we found](https://mudongliang.github.io/x86/html/file_module_x86_id_183.html)).

To be frank, we don't particularly know how to get cyclic to work with 64 bit executable. 
Somehow the `RIP` will just calls exit. We are not sure if this is because of `NX` or something else. 

So, we are going to find the offset the manual way:

We found out that the offset for this executable is around `65`
via running `python -c 'print("A" * 65)' | ./vuln`.
(This also perfectly matches the buffer size in the c source code being `64`).

However, it seems like the RIP has not really been overwritten at this address yet. 

So we go into `pwndbg` (a tool that extends the normal `gdb`) and try to see what is going on by inputting 65 characters and then gradually incrementing...

It seems like we have to also overwrite the `RBP` first before getting to the `RIP`, 
which we found out to be `72` (64+8 bytes in `RBP`)`.

After that, we made our [script.py](script.py) to match the buffer overflow attack needed:
- using `amd64` as the context architecture

However, when we tried to run the `script.py`. It seems to `SIGSEGV`.
We found out after this that there's a hint on the picoCTF site saying the following:

```
Jump to the second instruction (the one after the first push) in the flag function, if you're getting mysterious segmentation faults.
```

So what we did is go back to `pwndbg` and then `disassemble flag` to see the addresses we have to "jump" to:

```
Dump of assembler code for function flag:
   0x0000000000401236 <+0>:     endbr64 
   0x000000000040123a <+4>:     push   rbp
   0x000000000040123b <+5>:     mov    rbp,rsp
```

Ah, it seems like we probably have to not `push` the `RBP` and go straight to the `mov` instruction at `0x40123b`. 

So we change our python script as such... and it seems like our exploit passed through!

We ran it on the server and get our flag: `picoCTF{b1663r_15_b3773r_011d4bd8}`