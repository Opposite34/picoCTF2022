### Current progress: Done

A `vuln` and `vuln.c` file and source code file is given

`vuln` is a i386, 32bit little endian executable (checked via `checksec` command).
It also has NX enabled.

Looking into the code, we found something interesting with it:
```c
#define CANARY_SIZE 4

...

if (memcmp(canary,global_canary,CANARY_SIZE)) {
    printf("***** Stack Smashing Detected ***** : Canary Value Corrupt!\n"); // crash immediately
    exit(-1);
}
```
Seems like the file has its own stack canary check!
The canary seems to be 4 bytes in size.

Let's set the `canary.txt` file for testing locally to `test` for now and deal with the canary later.

After this, we found from the source code that we have to specify the write size - the file will only read as much as we said:

```c
#define BUFSIZE 64

...

void vuln(){
   ...

   printf("How Many Bytes will You Write Into the Buffer?\n> ");

   while (x<BUFSIZE) {
      read(0,length+x,1);
      if (length[x]=='\n') break;
      x++;
   }
   sscanf(length,"%d",&count);

   printf("Input> ");
   read(0,buf,count);

   ...
}
```

However, it seems like the code stills rely on `BUFSIZE` which is set to 64.
This means that we can still allow overflowing by giving the write input a large number, and it would all be okay for us to do the exploit.

With our knowledge above, we: 
- Used `pwndbg`
- Set the breakpoint at the end of main
- Did some fuzzing with the offset
- Checked the `RIP` address if it is overwritten correct

In which we found out how our payload would look like:
```
64-byte offset + canary + 16-byte offset + address to execute (win func)
```

Using above payload design with the local canary value of `test`, we successfully executed the exploit and got our test flag.

After that, we look into how to bypass the canary. It seems like since the program gets it from `canary.txt`, that means that it won't change everytime we run the binary.

This means that we can crack the bytes of the canary one by one, and then we will eventually get all 4 bytes and able to bypass it. You can watch [Aaron Yoo's video](https://youtu.be/N7kGd76evsM) on this topic which explains the concept in a very simple manner.

We ran the [exploit.py](exploit.py) pwntools script and got the following output:
```
[*] CANARY FOUND
b'BiRd'
[*] RUNNING ATTACK
[+] Opening connection to saturn.picoctf.net on port 55924: Done

...

[*] Closed connection to saturn.picoctf.net port 55924
picoCTF{Stat1C_c4n4r13s_4R3_b4D_f7c1f50a}
```

From output above, we found the canary to be `b'BiRd'`.
We also found our flag: `picoCTF{Stat1C_c4n4r13s_4R3_b4D_f7c1f50a}`